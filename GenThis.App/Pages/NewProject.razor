@page "/newproject"
@inject HttpClient httpClient
@inject NavigationManager navigationManager

<h3>New Project</h3>

<div class="mb-3">
    <label class="form-label">Name</label>
    <input type="text" class="form-control" placeholder="Type Project Name..." @bind="project.Name">
</div>

<div class="mb-3">
    <label class="form-label">Description</label>
    <textarea class="form-control" rows="3" placeholder="Type Project Description..." @bind="project.Description"></textarea>
</div>
@if (showErrorMessage) 
{ 
<div class="alert alert-danger" role="alert">
    @errorMessage
</div>
}
<button type="button" class="btn btn-primary mb-3" @onclick="Save">Save</button>

@code {

    Project project = new Project();
    bool showErrorMessage = false;
    string errorMessage = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        
    }

    private async Task Save()
    {
        var response = await httpClient.PostAsJsonAsync("Project/Save", project);
        var returnData = await response.Content.ReadFromJsonAsync<APIResult<Project>>();

        if (returnData.Result)
        {
            navigationManager.NavigateTo("projects");
        }
        else
        {
            showErrorMessage = true;
            errorMessage = returnData.Message;
        }
    }
}
